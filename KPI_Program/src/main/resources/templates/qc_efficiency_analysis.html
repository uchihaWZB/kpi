<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="base/main">
<head>
    <meta charset="UTF-8">
    <title>岸桥作业效率分析</title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

</head>
<body>

<div class="page-content-wrapper">
    <div class="page-content">

        <div layout:fragment="content">

            <!-- 查询模块 -->
            <div layout:fragment="query">
                <div class="col-md-12">
                    <div class="portlet light">
                        <div class="portlet-body">
                            <form action="" th:method="post" class="form-horizontal">
                                <div class="form-body">

                                    <!-- 第一行 -->
                                    <div class="row">

                                        <!-- 查询条件1 -->
                                        <div class="col-md-4" layout:fragment="query_condition_1">
                                            <div class="form-group col-md-12">
                                                <div class="input-group" id="defaultrange">
                                                    <input type="text" class="form-control" name="job_date" placeholder="作业日期" />
                                                    <span class="input-group-btn">
																		<button class="btn default date-range-toggle" type="button">
																			<i class="fa fa-calendar"></i>
																		</button>
													</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 查询条件2 -->
                                        <!--<div class="col-md-4" layout:fragment="query_condition_2">
                                            <div class="form-group col-md-12">
                                                <select id="job_class" name="job_class"
                                                        class="form-control select2-multiple select2-allow-clear"
                                                        multiple="multiple" data-placeholder="作业工班">
                                                    <option value="1" selected="selected">白班</option>
                                                    <option value="2" selected="selected">夜班</option>
                                                </select>
                                            </div>
                                        </div>

                                        &lt;!&ndash; 查询条件3 &ndash;&gt;
                                        <div class="col-md-4" layout:fragment="query_condition_3">
                                            <div class="form-group col-md-12">
                                                <select id="job_type" name="job_type"
                                                        class="form-control select2-multiple select2-allow-clear"
                                                        multiple="multiple" data-placeholder="作业类型">
                                                    <option value="1" selected="selected">装船</option>
                                                    <option value="2" selected="selected">卸船</option>
                                                </select>
                                            </div>
                                        </div>-->


                                    <div class="form-actions">
                                            <div class="col-md-4">
                                                <button type="button" class="btn green" id="searchBtn">查 询</button>
                                            </div>
                                    </div>

                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 数据展示模块 -->
            <div layout:fragment="data">
                <div class="row">
                    <div class="col-md-12">
                        <div class="portlet light">
                            <div id="qcEfficiency" style="height: 700px;">

                                <!-- 用以展示岸桥效率图表 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" layout:fragment="script" th:inline="javascript">

    $(function () {

        var legendDataOfQcIds = [[${qcIds}]];               // 获取到的Echart legend值 QC_Id
        var xAxisDataOfCreateds = [[${qcCreateds}]];        // 获取到的Echart xAxis横坐标值 创建时间
        var QcSeriesLabels = [[${qcSeriesLabels}]];         // Echart中series的分组数据，总组数
        var QcCountSeries = [[${qcCountSeries}]];           // Echart中series的分组数据，各组总数，折线数据

        //var QC_JobEfficiencyList = [[#{qcJobs}]];           // 获取到的QcJobEfficiencyVO记录


        console.log(QcSeriesLabels);
        console.log(QcCountSeries);

        /********组装series的数据 Start********/
        var QcSeries = [];

        for (var index in QcSeriesLabels) {

            QcSeries.push({
                name : legendDataOfQcIds[index],
                type : 'bar',
                barMaxWidth : '60',
                label : {
                    normal : {
                        show : true,
                        position : 'top'
                    }
                },
                data : QcSeriesLabels[index]
            });
        }

        legendDataOfQcIds.push('固定时间内总工作效率');
        QcSeries.push({
            name : '固定时间内总工作效率',
            type : 'line',
            data : QcCountSeries
        });
        /********组装series的数据 End********/

        var QC_JobEifficiencyEchart = echarts.init(document.getElementById('qcEfficiency'), 'walden');

        var QC_JobEfficiencyOption = {
            title : {
                text : '岸桥作业效率',
                left : 'center'
            },
            tooltip : {
                trigger : 'axis',
                axisPointer : { // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow' // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            toolbox : {
                feature : {
                    saveAsImage : {
                        show : true
                    }
                }
            },
            legend : {
                data : legendDataOfQcIds,
                top : 30,
            },
            xAxis : [ {
                type : 'category',
                data : xAxisDataOfCreateds,
                axisLabel : {
                    interval : 0,
                    margin : 30,
                    textStyle : {
                        fontSize : 14
                    }
                },
                axisPointer : {
                    type : 'shadow'
                },
                splitLine : {
                    show : true
                }
            } ],
            yAxis : [{
                type : 'value',
                name : '效率（数量/小时）',
                nameLocation : 'end',
                nameTextStyle : {
                    fontSize : 15
                }
            }],
            grid : { // 控制图的大小，调整下面这些值就可以，
                x : 100,
                x2 : 100,
                y2 : 190,// y2可以控制 X轴跟Zoom控件之间的间隔，避免以为倾斜后造成 label重叠到zoom上
            },
            dataZoom : [ {
                type : 'slider',
                start : 0,
                end : 30
                //slider的默认结束位置，该值可影响柱子的宽度
            } ],
            series : QcSeries
        };

        QC_JobEifficiencyEchart.setOption(QC_JobEfficiencyOption);
    });

</script>

</body>
</html>